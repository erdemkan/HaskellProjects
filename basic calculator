import Text.Read (readMaybe)

data Operation = Add | Subtract | Multiply | Divide | Exponantiate

parseOperation :: String -> Maybe Operation
parseOperation "+" = Just Add
parseOperation "-" = Just Subtract
parseOperation "*" = Just Multiply
parseOperation "/" = Just Divide
parseOperation "**" = Just Exponantiate
parseOperation "_" = Nothing

performOperation :: Operation -> Float -> Float -> Float
performOperation Add = (+)
performOperation Subtract = (-)
performOperation Multiply = (*)
performOperation Divide = (/)
performOperation Exponantiate = (**)

calculator :: String -> String -> String -> Maybe Float
calculator x operator y = do
  a <- readMaybe x
  b <- readMaybe y
  o <- parseOperation operator
  return (performOperation o a b)

main :: IO ()
main = do
  putStrLn "Enter the first number:"
  x <- getLine
  putStrLn "Enter the operator(+, -, *, /, **):"
  operator <- getLine
  putStrLn "Enter the second number:"
  y <- getLine
  case calculator x operator y of
    Just result -> putStrLn ("Result: " ++ x ++ " " ++ operator ++ " " ++ y ++ " = " ++ show result)
    Nothing -> putStrLn "Invalid input"
 